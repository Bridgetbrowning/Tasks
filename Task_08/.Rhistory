setwd(C:\Users\bdb00009\Desktop\Evolution\Tasks\Task_8)
setwd(C:\Users\bdb00009\Desktop\Evolution\Tasks\Task_8)
setwd(C:\Users\bdb00009\Desktop\Evolution\Tasks\Task_8)
setwd("C:\\Users\\bdb00009\\Desktop\\Evolution\\Tasks\\Task_08")
setwd("C:\\Users\\bdb00009\\Desktop\\Evolution\\Tasks\\Task_08")
source("C:/Users/bdb00009/Desktop/task04.r")
setwd("C:\\Users\\bdb00009\\Desktop\\Evolution\\Tasks\\Task_08")
setwd("C:\\Users\\bdb00009\\Desktop\\Evolution\\Tasks\\Task_08")
library(phytools)
trees <- list()
births <- vector()
Fractions <- vector()
for(i in 1:100){
births[i]<- runif(1, min=1, max=100)
Fractions[i]<- runif(1, min=1, max=100)
trees[[i]]<- pbtree(n=100, lamba=births[i], mu=births[i]*Fractions)
}
plot(trees[[i]])
div_rate<- sapply(trees,function(x)x$lambda-x$mu)
random<- c()
random2<- c()
treelist<- c()
for(i in 1:100){
births[i]<- runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(n=100, b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<- (Fractions[i])
treelist[[i]]<- mean(trees[[i]]$edge.length)
}
trees <- list()
births <- vector()
Fractions <- vector()
random<- c()
random2<- c()
treelist<- c()
for(i in 1:100){
births[i]<- runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(n=100, b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<- (Fractions[i])
treelist[[i]]<- mean(trees[[i]]$edge.length)
}
pdf('task08tree1')
for(i in 1:100){
births[i]<- runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(n=100, b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<- (Fractions[i])
treelist[[i]]<- mean(trees[[i]]$edge.length)
}
pdf('task08tree1')
plot(trees[[i]])
dev.off()
setwd("C:\\Users\\bdb00009\\Desktop\\Evolution\\Tasks\\Task_08")
trees <- list()
births <- vector()
Fractions <- vector()
random<- c()
random2<- c()
treelist<- c()
for(i in 1:100){
births[i]<- runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(n=100, b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<- (Fractions[i])
treelist[[i]]<- mean(trees[[i]]$edge.length)
}
pdf('task08tree1')
plot(trees[[i]])
dev.off()
sapply(trees,Ntip)
tips<- log(sapply(trees,Ntip))
random3<- unlist(random)
head(tips)
pdf('task08trees2')
plot(tips,xlab="log of tips", ylab="net diversification")
dev.off()
source("C:/Users/bdb00009/Desktop/task04.r")
div_rate<- sapply(trees,function(x) length(x$tip.labe))
log_tips<- log(sapply(trees, function(x) lenght(x$tip.label)))
div_rate<- sapply(trees,function(x) length(x$tip.label))
log_tips<- log(sapply(trees, function(x) lenght(x$tip.label)))
log_tips<- log(sapply(trees, function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate, log_tips), aes(x= log_tips, y=div_rate))+
geom_point()+
xlab("Log Number of Tips")+
ylab("Net Diversification")+
ggplot(data = data.frame(div_rate, log_tips), aes(x= log_tips, y=div_rate))+
geom_point()+
xlab("Log Number of Tips")+
ylab("Net Diversification")+
ggtitle("Net Diversification vs. Log Number of Tips")
dev.off()
speciation_rate<-sapply(births, function(x)x)
avg_branchlength<- sapply(trees, function(x) mean(x$edge.length, na.rm=TRUE))
ggplot(data = data.frame(speciation_rate, avg_branchlength), aes(x=speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ggplot(data = data.frame(speciation_rate, avg_branchlength), aes(x=speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ylab("Average Branch Length")+
ggplot(data = data.frame(speciation_rate, avg_branchlength), aes(x=speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ylab("Average Branch Length")+
ggtitle("Speciation Rate vs. Average Branch Length")
speciation_rate<-sapply(births, function(x)x)
avg_branchlength<- sapply(trees, function(x) mean(x$edge.length, na.rm=TRUE))
ggplot(data = data.frame(speciation_rate, avg_branchlength), aes(x=speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ylab("Average Branch Length")+
ggtitle("Speciation Rate vs. Average Branch Length")
dev.off()
cor(speciation_rate, avg_branchlength)
largest_tree<- trees[[which.max(sapply(trees, length))]]
Tree<- largest_tree
plot(Tree)
dev.off()
rates<- c()
traits<- list()
rates<- c()
traits<- list()
for(i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
}
mean_traits <- sapply(traits, mean)
cor(mean_traits, rates)
plot(rates, mean_treaits, xlab="Rates", ylab="Variance of Traits")
plot(rates, mean_traits, xlab="Rates", ylab="Variance of Traits")
dev.off()
var_traits <- sapply(traits, var)
cor(var_traits, rates)
plot(rates, var_traits, xlab="Rates", ylab="Variance of Traits")
dev.off()
cor(traits[[1]], trait[[2]])
cor(traits[[1]], traits[[2]])
traitMat <- cbind(traits[[1]], traits[[4]])
plot(traitMat)
dev.off()
phylomorphospace(Tree, traitMat, xlab="Trait 1", ylab= "Trait 2")
dev.off()
setwd("C:\\Users\\bdb00009\\Desktop\\Evolution\\Tasks\\Task_08")
trees <- list()
births <- vector()
Fractions <- vector()
random<- c()
random2<- c()
treelist<- c()
for(i in 1:100){
births[i]<- runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(n=100, b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<- (Fractions[i])
treelist[[i]]<- mean(trees[[i]]$edge.length)
}
pdf('task08tree1')
plot(trees[[i]])
dev.off()
sapply(trees,Ntip)
tips<- log(sapply(trees,Ntip))
random3<- unlist(random)
head(tips)
pdf('task08trees2')
plot(tips,xlab="log of tips", ylab="net diversification")
dev.off()
div_rate<- sapply(trees,function(x) length(x$tip.label))
log_tips<- log(sapply(trees, function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate, log_tips), aes(x= log_tips, y=div_rate))+
geom_point()+
xlab("Log Number of Tips")+
ylab("Net Diversification")+
ggtitle("Net Diversification vs. Log Number of Tips")
dev.off()
speciation_rate<-sapply(births, function(x)x)
avg_branchlength<- sapply(trees, function(x) mean(x$edge.length, na.rm=TRUE))
ggplot(data = data.frame(speciation_rate, avg_branchlength), aes(x=speciation_rate, y=avg_branchlength))+
geom_point()+
xlab("Speciation Rate")+
ylab("Average Branch Length")+
ggtitle("Speciation Rate vs. Average Branch Length")
dev.off()
cor(speciation_rate, avg_branchlength)
largest_tree<- trees[[which.max(sapply(trees, length))]]
Tree<- largest_tree
plot(Tree)
dev.off()
rates<- c()
traits<- list()
for(i in 1:100){
rates[i]<- runif(1)
traits[[i]]<- fastBM(tree=Tree, sig2=rates[i])
}
mean_traits <- sapply(traits, mean)
cor(mean_traits, rates)
plot(rates, mean_traits, xlab="Rates", ylab="Variance of Traits")
dev.off()
var_traits <- sapply(traits, var)
cor(var_traits, rates)
plot(rates, var_traits, xlab="Rates", ylab="Variance of Traits")
dev.off()
cor(traits[[1]], traits[[2]])
traitMat <- cbind(traits[[1]], traits[[4]])
plot(traitMat)
dev.off()
phylomorphospace(Tree, traitMat, xlab="Trait 1", ylab= "Trait 2")
dev.off()
phylomorphospace(Tree, traitMat, xlab="Trait 1", ylab= "Trait 2")
for(i in 1:100){
births[i]<- runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(n=100, b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<- (Fractions[i])
treelist[[i]]<- mean(trees[[i]]$edge.length)
}
pdf('task08tree1')
plot(trees[[i]])
source("C:/Users/bdb00009/Desktop/task08.r")
source("C:/Users/bdb00009/Desktop/task08.r")
source("C:/Users/bdb00009/Desktop/task08.r")
setwd("C:\\Users\\bdb00009\\Desktop\\Evolution\\Tasks\\Task_08")
source("C:/Users/bdb00009/Desktop/task08.r")
